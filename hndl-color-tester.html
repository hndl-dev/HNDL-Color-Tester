<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HNDL Color Palette Tester</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
<style>
  :root {
    --navy: #083359;
    --neutral: #f5f5f5;
    --current-accent: #a6ed0c;
    --surface: #0a0e1a;
    --surface-light: #111827;
    --text: #e2e8f0;
    --text-muted: #94a3b8;
    --border: #1e293b;
  }

  body.light-mode {
    --surface: #f6f7f9;
    --surface-light: #ffffff;
    --text: #1e293b;
    --text-muted: #64748b;
    --border: #e2e8f0;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Plus Jakarta Sans', sans-serif;
    background: var(--surface);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  .grain {
    position: fixed;
    inset: 0;
    opacity: 0.03;
    pointer-events: none;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    z-index: 9999;
  }

  header {
    padding: 2.5rem 3rem 1.5rem;
    border-bottom: 1px solid var(--border);
  }

  header h1 {
    font-size: 1.5rem;
    font-weight: 800;
    letter-spacing: -0.02em;
    margin-bottom: 0.25rem;
  }

  header p {
    color: var(--text-muted);
    font-size: 0.875rem;
    font-family: 'DM Sans', sans-serif;
  }

  .layout {
    display: grid;
    grid-template-columns: 320px 1fr;
    min-height: calc(100vh - 90px);
  }

  /* Sidebar */
  .sidebar {
    border-right: 1px solid var(--border);
    padding: 1.5rem;
    overflow-y: auto;
    max-height: calc(100vh - 90px);
  }

  .sidebar-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1rem;
  }

  .sidebar h2 {
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    color: var(--text-muted);
    font-weight: 600;
  }

  .sidebar-header h2 {
    margin-bottom: 0;
  }

  .color-group {
    margin-bottom: 1.5rem;
  }

  .color-group-label {
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--text-muted);
    margin-bottom: 0.5rem;
    font-weight: 500;
    opacity: 0.7;
  }

  .color-option {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.6rem 0.75rem;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 2px solid transparent;
    margin-bottom: 0.25rem;
    position: relative;
  }

  .color-option:hover {
    background: rgba(255,255,255,0.04);
  }

  .color-option.active {
    background: rgba(255,255,255,0.06);
    border-color: var(--current-accent);
  }

  .color-option .pin-btn {
    opacity: 0;
    transition: opacity 0.2s;
    background: none;
    border: none;
    color: var(--text-muted);
    cursor: pointer;
    font-size: 0.85rem;
    padding: 0.2rem;
    border-radius: 4px;
    flex-shrink: 0;
  }

  .color-option:hover .pin-btn,
  .color-option .pin-btn.pinned {
    opacity: 1;
  }

  .color-option .pin-btn.pinned {
    color: var(--current-accent);
  }

  .color-option .pin-btn:hover {
    background: rgba(255,255,255,0.08);
  }

  .color-option.aa-filtered {
    opacity: 0.25;
    pointer-events: none;
  }

  .color-swatch {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    flex-shrink: 0;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  }

  .color-info {
    flex: 1;
    min-width: 0;
  }

  .color-name {
    font-size: 0.8rem;
    font-weight: 600;
    margin-bottom: 1px;
  }

  .color-hex {
    font-size: 0.7rem;
    color: var(--text-muted);
    font-family: 'DM Sans', monospace;
    cursor: pointer;
    position: relative;
    display: inline-block;
  }

  .color-hex:hover {
    color: var(--text);
  }

  /* AA Filter Toggle */
  .aa-filter-toggle {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    cursor: pointer;
    user-select: none;
    font-size: 0.6rem;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.06em;
    padding: 0.25rem 0.5rem;
    border-radius: 6px;
    border: 1px solid var(--border);
    background: transparent;
    transition: all 0.2s;
  }

  .aa-filter-toggle:hover {
    border-color: var(--text-muted);
  }

  .aa-filter-toggle.active {
    background: rgba(34,197,94,0.12);
    border-color: #22c55e;
    color: #22c55e;
  }

  .aa-filter-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--text-muted);
    transition: background 0.2s;
  }

  .aa-filter-toggle.active .aa-filter-dot {
    background: #22c55e;
  }

  /* Custom color input */
  .custom-section {
    margin-top: 1.5rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--border);
  }

  .custom-input-row {
    display: flex;
    gap: 0.5rem;
    align-items: center;
  }

  .custom-input-row input[type="color"] {
    width: 40px;
    height: 36px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    background: none;
    padding: 0;
  }

  .custom-input-row input[type="color"]::-webkit-color-swatch-wrapper { padding: 2px; }
  .custom-input-row input[type="color"]::-webkit-color-swatch { border-radius: 6px; border: none; }

  .custom-input-row input[type="text"] {
    flex: 1;
    background: var(--surface-light);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 0.5rem 0.75rem;
    border-radius: 8px;
    font-family: 'DM Sans', monospace;
    font-size: 0.8rem;
    outline: none;
    transition: border-color 0.2s;
  }

  .custom-input-row input[type="text"]:focus {
    border-color: var(--current-accent);
  }

  .custom-input-row button {
    background: var(--current-accent);
    color: var(--navy);
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    font-weight: 700;
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
  }

  .custom-input-row button:hover { opacity: 0.85; }

  /* Main preview area */
  .preview-area {
    padding: 2.5rem;
    display: flex;
    flex-direction: column;
    gap: 2rem;
    overflow-y: auto;
    max-height: calc(100vh - 90px);
  }

  /* Logo preview */
  .logo-preview-card {
    background: var(--navy);
    border-radius: 20px;
    padding: 3rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1.5rem;
    box-shadow: 0 20px 60px rgba(0,0,0,0.4);
    position: relative;
    overflow: hidden;
  }

  .logo-preview-card::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse at 30% 50%, rgba(255,255,255,0.03) 0%, transparent 70%);
  }

  .logo-text {
    font-size: 5rem;
    font-weight: 800;
    letter-spacing: -0.03em;
    color: var(--current-accent);
    position: relative;
    z-index: 1;
    line-height: 1;
    transition: color 0.4s ease;
  }

  .logo-badge {
    position: relative;
    z-index: 1;
    width: 110px;
    height: 90px;
    border: 3px solid rgba(255,255,255,0.2);
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
  }

  .logo-badge span {
    font-size: 0.65rem;
    font-weight: 600;
    color: var(--current-accent);
    letter-spacing: 0.08em;
    text-align: center;
    line-height: 1.3;
    transition: color 0.4s ease;
  }

  /* Preview cards grid */
  .preview-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.25rem;
  }

  .preview-card {
    border-radius: 16px;
    padding: 1.75rem;
    position: relative;
    overflow: hidden;
  }

  .preview-card h3 {
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin-bottom: 1rem;
    opacity: 0.6;
    font-weight: 600;
  }

  /* Card: On Navy */
  .card-on-navy {
    background: var(--navy);
  }

  .card-on-navy .sample-text {
    color: var(--current-accent);
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    transition: color 0.4s ease;
  }

  .card-on-navy .sample-body {
    color: rgba(255,255,255,0.6);
    font-size: 0.8rem;
    line-height: 1.6;
    font-family: 'DM Sans', sans-serif;
  }

  .card-on-navy h3 { color: rgba(255,255,255,0.4); }

  /* Card: On White */
  .card-on-white {
    background: var(--neutral);
  }

  .card-on-white .sample-text {
    color: var(--current-accent);
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    transition: color 0.4s ease;
  }

  .card-on-white .sample-body {
    color: rgba(0,0,0,0.5);
    font-size: 0.8rem;
    line-height: 1.6;
    font-family: 'DM Sans', sans-serif;
  }

  .card-on-white h3 { color: rgba(0,0,0,0.35); }

  /* Card: Button styles */
  .card-buttons {
    background: var(--surface-light);
    border: 1px solid var(--border);
  }

  .card-buttons h3 { color: var(--text-muted); }

  .btn-row {
    display: flex;
    flex-direction: column;
    gap: 0.6rem;
  }

  .btn-sample {
    padding: 0.65rem 1.25rem;
    border-radius: 10px;
    font-size: 0.8rem;
    font-weight: 600;
    border: none;
    cursor: pointer;
    text-align: center;
    transition: all 0.4s ease;
  }

  .btn-filled {
    background: var(--current-accent);
    color: var(--navy);
  }

  .btn-outline {
    background: transparent;
    border: 2px solid var(--current-accent);
    color: var(--current-accent);
  }

  .btn-ghost {
    background: rgba(166, 237, 12, 0.1);
    color: var(--current-accent);
    transition: all 0.4s ease;
  }

  /* Card: Dashboard mock */
  .card-dashboard {
    background: var(--surface-light);
    border: 1px solid var(--border);
  }

  .card-dashboard h3 { color: var(--text-muted); }

  .dash-stats {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.75rem;
  }

  .dash-stat {
    background: rgba(255,255,255,0.03);
    border-radius: 10px;
    padding: 0.85rem;
    border: 1px solid var(--border);
  }

  .dash-stat-label {
    font-size: 0.6rem;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    margin-bottom: 0.35rem;
  }

  .dash-stat-value {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--current-accent);
    transition: color 0.4s ease;
  }

  .dash-bar-chart {
    margin-top: 0.75rem;
    display: flex;
    align-items: flex-end;
    gap: 4px;
    height: 50px;
  }

  .dash-bar {
    flex: 1;
    border-radius: 3px 3px 0 0;
    background: var(--current-accent);
    transition: background 0.4s ease, height 0.3s ease;
    opacity: 0.7;
  }

  .dash-bar:nth-child(odd) { opacity: 0.4; }

  /* Contrast info */
  .contrast-section {
    background: var(--surface-light);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 1.5rem 1.75rem;
  }

  .contrast-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: 1.25rem;
    gap: 1rem;
  }

  .contrast-section h3 {
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--text-muted);
    font-weight: 600;
  }

  /* Suitability Score */
  .score-display {
    display: flex;
    align-items: center;
    gap: 0.6rem;
    flex-shrink: 0;
  }

  .score-ring {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.85rem;
    font-weight: 800;
    position: relative;
  }

  .score-ring::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 50%;
    border: 3px solid var(--border);
  }

  .score-ring::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 50%;
    border: 3px solid transparent;
    border-top-color: currentColor;
    border-right-color: currentColor;
  }

  .score-label {
    font-size: 0.7rem;
    font-weight: 600;
    line-height: 1.2;
  }

  .score-sublabel {
    font-size: 0.6rem;
    color: var(--text-muted);
    font-weight: 400;
  }

  .score-excellent { color: #22c55e; }
  .score-good { color: #84cc16; }
  .score-fair { color: #f59e0b; }
  .score-poor { color: #ef4444; }

  .contrast-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
  }

  .contrast-item {
    text-align: center;
  }

  .contrast-label {
    font-size: 0.7rem;
    color: var(--text-muted);
    margin-bottom: 0.35rem;
    font-family: 'DM Sans', sans-serif;
  }

  .contrast-ratio {
    font-size: 1.4rem;
    font-weight: 700;
    transition: color 0.3s ease;
  }

  .contrast-badge {
    display: inline-block;
    font-size: 0.6rem;
    font-weight: 700;
    padding: 0.15rem 0.5rem;
    border-radius: 4px;
    margin-top: 0.25rem;
    letter-spacing: 0.05em;
  }

  .badge-pass-aaa { background: rgba(234,179,8,0.15); color: #eab308; }
  .badge-pass { background: rgba(34,197,94,0.15); color: #22c55e; }
  .badge-warn { background: rgba(245,158,11,0.15); color: #f59e0b; }
  .badge-fail { background: rgba(239,68,68,0.15); color: #ef4444; }

  /* Color comparison strip */
  .comparison-strip {
    display: flex;
    gap: 0.75rem;
    padding: 1.25rem;
    background: var(--surface-light);
    border: 1px solid var(--border);
    border-radius: 16px;
    overflow-x: auto;
  }

  .strip-swatch {
    flex: 1;
    min-width: 60px;
    aspect-ratio: 1;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.25s ease;
    position: relative;
    border: 2px solid transparent;
  }

  .strip-swatch:hover { transform: scale(1.08); }
  .strip-swatch.active-strip {
    border-color: white;
    box-shadow: 0 0 20px rgba(255,255,255,0.15);
    transform: scale(1.08);
  }

  .strip-swatch.pinned-strip::after {
    content: '';
    position: absolute;
    top: 4px;
    right: 4px;
    width: 8px;
    height: 8px;
    background: white;
    border-radius: 50%;
    box-shadow: 0 1px 3px rgba(0,0,0,0.4);
  }

  .strip-swatch-label {
    position: absolute;
    bottom: -20px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.55rem;
    color: var(--text-muted);
    white-space: nowrap;
    font-weight: 500;
  }

  .strip-wrapper {
    padding-bottom: 1.5rem;
  }

  /* Tint/Shade Palette Strip */
  .palette-section {
    background: var(--surface-light);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 1.25rem 1.5rem;
  }

  .palette-section h3 {
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--text-muted);
    margin-bottom: 0.75rem;
    font-weight: 600;
  }

  .palette-row {
    display: flex;
    gap: 4px;
    align-items: stretch;
  }

  .palette-swatch {
    flex: 1;
    height: 40px;
    cursor: pointer;
    position: relative;
    transition: transform 0.15s ease, box-shadow 0.15s ease;
    border: none;
    outline: none;
    padding: 0;
  }

  .palette-swatch:first-child { border-radius: 8px 0 0 8px; }
  .palette-swatch:last-child { border-radius: 0 8px 8px 0; }

  .palette-swatch:hover {
    transform: scaleY(1.2);
    z-index: 2;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  }

  .palette-swatch.palette-origin {
    border-bottom: 3px solid white;
  }

  .palette-swatch-tooltip {
    position: absolute;
    bottom: calc(100% + 6px);
    left: 50%;
    transform: translateX(-50%);
    background: var(--surface);
    border: 1px solid var(--border);
    color: var(--text);
    font-size: 0.6rem;
    font-family: 'DM Sans', monospace;
    padding: 0.2rem 0.4rem;
    border-radius: 4px;
    white-space: nowrap;
    display: none;
    z-index: 10;
    pointer-events: none;
  }

  .palette-swatch:hover .palette-swatch-tooltip {
    display: block;
  }

  /* Color Harmony Section */
  .harmony-section {
    background: var(--surface-light);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 1.25rem 1.5rem;
  }

  .harmony-section h3 {
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--text-muted);
    margin-bottom: 0.75rem;
    font-weight: 600;
  }

  .harmony-group {
    margin-bottom: 0.75rem;
  }

  .harmony-group:last-child {
    margin-bottom: 0;
  }

  .harmony-group-label {
    font-size: 0.6rem;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    margin-bottom: 0.35rem;
    font-weight: 500;
  }

  .harmony-swatches {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
  }

  .harmony-chip {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    padding: 0.3rem 0.5rem 0.3rem 0.3rem;
    border-radius: 8px;
    cursor: pointer;
    background: rgba(255,255,255,0.03);
    border: 1px solid var(--border);
    transition: all 0.2s;
  }

  .harmony-chip:hover {
    border-color: var(--text-muted);
    background: rgba(255,255,255,0.06);
  }

  .harmony-chip-swatch {
    width: 22px;
    height: 22px;
    border-radius: 5px;
    flex-shrink: 0;
  }

  .harmony-chip-info {
    display: flex;
    flex-direction: column;
    gap: 1px;
  }

  .harmony-chip-hex {
    font-size: 0.6rem;
    font-family: 'DM Sans', monospace;
    color: var(--text);
  }

  .harmony-chip-badge {
    font-size: 0.5rem;
    font-weight: 700;
    letter-spacing: 0.03em;
  }

  .harmony-chip-badge.aa-pass { color: #22c55e; }
  .harmony-chip-badge.aa-fail { color: #ef4444; }

  /* Copy tooltip */
  .copy-toast {
    position: fixed;
    bottom: 2rem;
    left: 50%;
    transform: translateX(-50%) translateY(10px);
    background: var(--navy);
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    font-size: 0.75rem;
    font-weight: 600;
    opacity: 0;
    transition: all 0.3s ease;
    pointer-events: none;
    z-index: 10000;
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  }

  .copy-toast.show {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }

  /* Side-by-side Comparison */
  .comparison-container {
    display: none;
    gap: 1.25rem;
    background: var(--surface-light);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 1.25rem;
  }

  .comparison-container.visible {
    display: flex;
  }

  .comparison-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 0.75rem;
  }

  .comparison-header h3 {
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--text-muted);
    font-weight: 600;
  }

  .clear-pins-btn {
    background: none;
    border: 1px solid var(--border);
    color: var(--text-muted);
    font-size: 0.65rem;
    font-weight: 600;
    padding: 0.2rem 0.6rem;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s;
  }

  .clear-pins-btn:hover {
    border-color: #ef4444;
    color: #ef4444;
  }

  .comparison-column {
    flex: 1;
    min-width: 0;
  }

  .comparison-column-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.75rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid var(--border);
  }

  .comparison-column-swatch {
    width: 24px;
    height: 24px;
    border-radius: 6px;
    flex-shrink: 0;
  }

  .comparison-column-name {
    font-size: 0.75rem;
    font-weight: 700;
  }

  .comparison-column-hex {
    font-size: 0.65rem;
    font-family: 'DM Sans', monospace;
    color: var(--text-muted);
  }

  .comp-logo {
    background: var(--navy);
    border-radius: 12px;
    padding: 1.25rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    margin-bottom: 0.75rem;
  }

  .comp-logo-text {
    font-size: 2rem;
    font-weight: 800;
    letter-spacing: -0.03em;
    line-height: 1;
  }

  .comp-logo-badge {
    width: 55px;
    height: 45px;
    border: 2px solid rgba(255,255,255,0.2);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .comp-logo-badge span {
    font-size: 0.4rem;
    font-weight: 600;
    letter-spacing: 0.06em;
    text-align: center;
    line-height: 1.3;
  }

  .comp-buttons {
    display: flex;
    flex-direction: column;
    gap: 0.4rem;
    margin-bottom: 0.75rem;
  }

  .comp-btn {
    padding: 0.45rem 0.75rem;
    border-radius: 8px;
    font-size: 0.7rem;
    font-weight: 600;
    text-align: center;
    border: none;
  }

  .comp-contrast-list {
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
  }

  .comp-contrast-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-size: 0.65rem;
    padding: 0.25rem 0;
  }

  .comp-contrast-bg {
    color: var(--text-muted);
    font-family: 'DM Sans', sans-serif;
  }

  .comp-contrast-value {
    font-weight: 700;
    font-family: 'DM Sans', monospace;
  }

  .comp-score {
    text-align: center;
    padding: 0.5rem;
    border-radius: 8px;
    margin-top: 0.5rem;
    font-weight: 700;
    font-size: 0.85rem;
  }

  /* Keyboard hints */
  .keyboard-hint {
    text-align: center;
    font-size: 0.6rem;
    color: var(--text-muted);
    opacity: 0.5;
    padding-top: 0.5rem;
    font-family: 'DM Sans', sans-serif;
  }

  .keyboard-hint kbd {
    background: var(--surface-light);
    border: 1px solid var(--border);
    padding: 0.1rem 0.3rem;
    border-radius: 3px;
    font-size: 0.55rem;
    font-family: 'DM Sans', monospace;
  }

  /* Light mode overrides for hardcoded colors */
  body.light-mode .grain { opacity: 0.015; }

  body.light-mode header {
    background: #ffffff;
    border-bottom-color: #e5e7eb;
  }

  body.light-mode .sidebar {
    background: #ffffff;
    border-right-color: #e5e7eb;
  }

  body.light-mode .color-option:hover {
    background: rgba(0,0,0,0.04);
  }

  body.light-mode .color-option.active {
    background: rgba(0,0,0,0.06);
  }

  body.light-mode .color-swatch {
    box-shadow: 0 2px 8px rgba(0,0,0,0.12);
  }

  body.light-mode .card-on-navy .sample-body {
    color: rgba(255,255,255,0.6);
  }

  body.light-mode .card-on-navy h3 { color: rgba(255,255,255,0.4); }

  /* Cards get white background + shadow in light mode */
  body.light-mode .preview-card {
    box-shadow: 0 1px 3px rgba(0,0,0,0.06), 0 4px 12px rgba(0,0,0,0.04);
    border: 1px solid #e5e7eb;
  }

  body.light-mode .card-on-white {
    background: #ffffff;
    border: 1px solid #e5e7eb;
  }

  body.light-mode .card-buttons,
  body.light-mode .card-dashboard,
  body.light-mode .card-form,
  body.light-mode .card-nav,
  body.light-mode .card-alerts,
  body.light-mode .card-controls,
  body.light-mode .card-table {
    background: #ffffff;
    border: 1px solid #e5e7eb;
  }

  body.light-mode .dash-stat {
    background: #f8f9fa;
    border-color: #e5e7eb;
  }

  body.light-mode .strip-swatch.active-strip {
    border-color: var(--navy);
    box-shadow: 0 0 20px rgba(0,0,0,0.15);
  }

  body.light-mode .logo-preview-card {
    box-shadow: 0 8px 30px rgba(0,0,0,0.12);
  }

  body.light-mode .color-option .pin-btn:hover {
    background: rgba(0,0,0,0.06);
  }

  body.light-mode .comparison-strip,
  body.light-mode .contrast-section,
  body.light-mode .palette-section,
  body.light-mode .harmony-section {
    background: #ffffff;
    border-color: #e5e7eb;
    box-shadow: 0 1px 3px rgba(0,0,0,0.04), 0 4px 12px rgba(0,0,0,0.03);
  }

  body.light-mode .harmony-chip {
    background: #f8f9fa;
    border-color: #e5e7eb;
  }

  body.light-mode .harmony-chip:hover {
    background: #f0f1f3;
    border-color: #d1d5db;
  }

  body.light-mode .copy-toast {
    background: var(--navy);
    color: white;
  }

  body.light-mode .table-mock {
    border-color: #e5e7eb;
  }

  body.light-mode .table-row {
    border-bottom-color: #f0f1f3;
  }

  body.light-mode .nav-user {
    border-top-color: #e5e7eb;
  }

  body.light-mode .toggle-switch:not(.on) {
    background: #d1d5db;
  }

  body.light-mode .comparison-container {
    background: #ffffff;
    border-color: #e5e7eb;
    box-shadow: 0 1px 3px rgba(0,0,0,0.04), 0 4px 12px rgba(0,0,0,0.03);
  }

  body.light-mode .custom-section {
    border-top-color: #e5e7eb;
  }

  /* Mode toggle */
  .mode-toggle {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    background: var(--surface-light);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 0.35rem 0.75rem;
    cursor: pointer;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--text);
    transition: all 0.3s ease;
    user-select: none;
  }

  .mode-toggle:hover {
    border-color: var(--current-accent);
  }

  .mode-toggle-icon {
    font-size: 1rem;
    line-height: 1;
  }

  .header-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  /* ══════ Realistic UI Preview Cards ══════ */

  /* Card: Form Elements */
  .card-form {
    background: var(--surface-light);
    border: 1px solid var(--border);
  }
  .card-form h3 { color: var(--text-muted); }

  .form-mock { display: flex; flex-direction: column; gap: 0.65rem; }

  .form-label {
    font-size: 0.65rem;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .form-input {
    background: var(--surface);
    border: 1.5px solid var(--border);
    border-radius: 8px;
    padding: 0.55rem 0.75rem;
    font-size: 0.8rem;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    transition: all 0.2s;
  }

  .form-input.focused {
    border-color: var(--current-accent);
    box-shadow: 0 0 0 3px rgba(var(--accent-rgb, 166,237,12), 0.15);
  }

  .form-select {
    background: var(--surface);
    border: 1.5px solid var(--border);
    border-radius: 8px;
    padding: 0.55rem 0.75rem;
    font-size: 0.8rem;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .form-select-arrow {
    color: var(--text-muted);
    font-size: 0.65rem;
  }

  .form-validation {
    font-size: 0.7rem;
    color: var(--current-accent);
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 0.3rem;
    transition: color 0.4s ease;
  }

  .form-checkbox-row {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.75rem;
    color: var(--text);
  }

  .form-checkbox {
    width: 18px;
    height: 18px;
    border-radius: 5px;
    border: 2px solid var(--border);
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.6rem;
    transition: all 0.2s;
  }

  .form-checkbox.checked {
    background: var(--current-accent);
    border-color: var(--current-accent);
    color: var(--navy);
  }

  .form-radio-row {
    display: flex;
    gap: 0.75rem;
  }

  .form-radio-item {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    font-size: 0.7rem;
    color: var(--text);
  }

  .form-radio {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    border: 2px solid var(--border);
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .form-radio.selected {
    border-color: var(--current-accent);
  }

  .form-radio.selected::after {
    content: '';
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--current-accent);
  }

  /* Card: Navigation */
  .card-nav {
    background: var(--surface-light);
    border: 1px solid var(--border);
  }
  .card-nav h3 { color: var(--text-muted); }

  .nav-mock {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .nav-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.55rem 0.75rem;
    border-radius: 8px;
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--text-muted);
    transition: all 0.2s;
    cursor: default;
    border-left: 3px solid transparent;
  }

  .nav-item.nav-active {
    background: rgba(var(--accent-rgb, 166,237,12), 0.08);
    color: var(--current-accent);
    border-left-color: var(--current-accent);
    font-weight: 600;
  }

  .nav-item-icon {
    font-size: 0.85rem;
    width: 20px;
    text-align: center;
    margin-right: 0.5rem;
    opacity: 0.6;
  }

  .nav-item.nav-active .nav-item-icon {
    opacity: 1;
  }

  .nav-item-left {
    display: flex;
    align-items: center;
  }

  .nav-badge {
    background: var(--current-accent);
    color: var(--navy);
    font-size: 0.55rem;
    font-weight: 700;
    padding: 0.1rem 0.4rem;
    border-radius: 10px;
    min-width: 18px;
    text-align: center;
    transition: all 0.4s ease;
  }

  .nav-user {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.6rem 0.75rem;
    margin-top: 0.5rem;
    border-top: 1px solid var(--border);
  }

  .nav-avatar {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: var(--current-accent);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.65rem;
    font-weight: 700;
    color: var(--navy);
    transition: background 0.4s ease;
  }

  .nav-user-info {
    display: flex;
    flex-direction: column;
  }

  .nav-user-name {
    font-size: 0.7rem;
    font-weight: 600;
    color: var(--text);
  }

  .nav-user-role {
    font-size: 0.6rem;
    color: var(--text-muted);
  }

  /* Card: Data Table */
  .card-table {
    background: var(--surface-light);
    border: 1px solid var(--border);
    grid-column: 1 / -1;
  }
  .card-table h3 { color: var(--text-muted); }

  .table-mock {
    border: 1px solid var(--border);
    border-radius: 10px;
    overflow: hidden;
  }

  .table-header {
    display: grid;
    grid-template-columns: 1.2fr 0.8fr 1.2fr 0.6fr 0.8fr;
    gap: 0.5rem;
    padding: 0.5rem 0.75rem;
    font-size: 0.6rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--text-muted);
    background: rgba(255,255,255,0.02);
    border-bottom: 1px solid var(--border);
  }

  .table-header span.sorted {
    color: var(--current-accent);
  }

  .table-row {
    display: grid;
    grid-template-columns: 1.2fr 0.8fr 1.2fr 0.6fr 0.8fr;
    gap: 0.5rem;
    padding: 0.55rem 0.75rem;
    font-size: 0.7rem;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    border-bottom: 1px solid var(--border);
    align-items: center;
    transition: background 0.2s;
    border-left: 3px solid transparent;
  }

  .table-row:last-child { border-bottom: none; }

  .table-row.row-selected {
    border-left-color: var(--current-accent);
  }

  .table-row-id {
    font-weight: 600;
    font-family: 'DM Sans', monospace;
    font-size: 0.7rem;
  }

  .status-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.3rem;
    font-size: 0.6rem;
    font-weight: 600;
    padding: 0.15rem 0.5rem;
    border-radius: 10px;
  }

  .status-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
  }

  .status-active .status-dot { background: var(--current-accent); }
  .status-active {
    background: rgba(var(--accent-rgb, 166,237,12), 0.1);
    color: var(--current-accent);
  }

  .status-idle .status-dot { background: #f59e0b; }
  .status-idle { background: rgba(245,158,11,0.1); color: #f59e0b; }

  .status-offline .status-dot { background: var(--text-muted); }
  .status-offline { background: rgba(148,163,184,0.1); color: var(--text-muted); }

  .table-progress {
    height: 4px;
    background: var(--border);
    border-radius: 2px;
    overflow: hidden;
  }

  .table-progress-fill {
    height: 100%;
    border-radius: 2px;
    background: var(--current-accent);
    transition: background 0.4s ease;
  }

  .table-action {
    font-size: 0.65rem;
    color: var(--current-accent);
    font-weight: 600;
    cursor: default;
    transition: color 0.4s ease;
  }

  /* Card: Alerts & Notifications */
  .card-alerts {
    background: var(--surface-light);
    border: 1px solid var(--border);
  }
  .card-alerts h3 { color: var(--text-muted); }

  .alerts-mock {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .alert-item {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    padding: 0.6rem 0.75rem;
    border-radius: 10px;
    font-size: 0.7rem;
    line-height: 1.4;
    font-family: 'DM Sans', sans-serif;
    border-left: 3px solid transparent;
  }

  .alert-icon {
    font-size: 0.85rem;
    flex-shrink: 0;
    line-height: 1.2;
  }

  .alert-info {
    background: rgba(var(--accent-rgb, 166,237,12), 0.06);
    border-left-color: var(--current-accent);
    color: var(--text);
  }

  .alert-info .alert-icon { color: var(--current-accent); }

  .alert-success {
    background: rgba(34,197,94,0.06);
    border-left-color: #22c55e;
    color: var(--text);
  }

  .alert-success .alert-icon { color: #22c55e; }

  .alert-warning {
    background: rgba(245,158,11,0.06);
    border-left-color: #f59e0b;
    color: var(--text);
  }

  .alert-warning .alert-icon { color: #f59e0b; }

  .alert-text strong {
    font-weight: 600;
  }

  .alert-time {
    font-size: 0.6rem;
    color: var(--text-muted);
    margin-top: 0.15rem;
  }

  /* Card: Toggles, Chips & Tags */
  .card-controls {
    background: var(--surface-light);
    border: 1px solid var(--border);
  }
  .card-controls h3 { color: var(--text-muted); }

  .controls-mock {
    display: flex;
    flex-direction: column;
    gap: 0.85rem;
  }

  .control-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .control-label {
    font-size: 0.75rem;
    color: var(--text);
    font-weight: 500;
  }

  .toggle-switch {
    width: 36px;
    height: 20px;
    border-radius: 10px;
    background: var(--border);
    position: relative;
    cursor: default;
    transition: background 0.3s;
  }

  .toggle-switch.on {
    background: var(--current-accent);
  }

  .toggle-switch::after {
    content: '';
    position: absolute;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: white;
    top: 2px;
    left: 2px;
    transition: transform 0.3s;
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
  }

  .toggle-switch.on::after {
    transform: translateX(16px);
  }

  .chips-row {
    display: flex;
    flex-wrap: wrap;
    gap: 0.35rem;
  }

  .chip {
    font-size: 0.6rem;
    font-weight: 600;
    padding: 0.2rem 0.55rem;
    border-radius: 6px;
    border: 1px solid var(--border);
    color: var(--text-muted);
    cursor: default;
    transition: all 0.2s;
  }

  .chip.chip-active {
    background: rgba(var(--accent-rgb, 166,237,12), 0.1);
    border-color: var(--current-accent);
    color: var(--current-accent);
  }

  .progress-bar-section {
    display: flex;
    flex-direction: column;
    gap: 0.3rem;
  }

  .progress-bar-label {
    display: flex;
    justify-content: space-between;
    font-size: 0.65rem;
  }

  .progress-bar-label span:first-child {
    color: var(--text);
    font-weight: 500;
  }

  .progress-bar-label span:last-child {
    color: var(--current-accent);
    font-weight: 700;
    transition: color 0.4s ease;
  }

  .progress-bar {
    height: 6px;
    background: var(--border);
    border-radius: 3px;
    overflow: hidden;
  }

  .progress-bar-fill {
    height: 100%;
    border-radius: 3px;
    background: var(--current-accent);
    transition: background 0.4s ease;
  }

  .link-text {
    color: var(--current-accent);
    font-size: 0.7rem;
    font-weight: 600;
    text-decoration: underline;
    text-underline-offset: 2px;
    cursor: default;
    transition: color 0.4s ease;
  }

  /* Light mode overrides for new cards */
  body.light-mode .table-row.row-selected {
    background: rgba(var(--accent-rgb, 166,237,12), 0.04);
  }

  body.light-mode .form-input {
    background: #f8f9fa;
    border-color: #d1d5db;
  }

  body.light-mode .form-select {
    background: #f8f9fa;
    border-color: #d1d5db;
  }

  body.light-mode .form-checkbox {
    border-color: #d1d5db;
  }

  body.light-mode .form-radio {
    border-color: #d1d5db;
  }

  body.light-mode .table-header {
    background: #f8f9fa;
    border-bottom-color: #e5e7eb;
  }

  body.light-mode .progress-bar {
    background: #e5e7eb;
  }

  body.light-mode .chip {
    border-color: #d1d5db;
    color: #6b7280;
  }

  body.light-mode .alert-item {
    border-radius: 10px;
  }

  body.light-mode .keyboard-hint kbd {
    background: #f0f1f3;
    border-color: #d1d5db;
  }

  @media (max-width: 900px) {
    .layout { grid-template-columns: 1fr; }
    .sidebar {
      max-height: none;
      border-right: none;
      border-bottom: 1px solid var(--border);
    }
    .preview-area { max-height: none; }
    .preview-grid { grid-template-columns: 1fr; }
    .card-table { grid-column: auto; }
    .table-mock { overflow-x: auto; }
    .logo-text { font-size: 3.5rem; }
    .contrast-grid { grid-template-columns: repeat(2, 1fr); }
    .comparison-container.visible { flex-direction: column; }
  }
</style>
</head>
<body>
<div class="grain"></div>

<!-- Copy toast notification -->
<div class="copy-toast" id="copyToast">Copied!</div>

<header>
  <div class="header-row">
    <div>
      <h1>HNDL Color Palette Tester</h1>
      <p>Explore accent color alternatives against your navy brand</p>
    </div>
    <button class="mode-toggle" onclick="toggleMode()">
      <span class="mode-toggle-icon" id="modeIcon">&#9790;</span>
      <span id="modeLabel">Dark</span>
    </button>
  </div>
</header>

<div class="layout">
  <aside class="sidebar">
    <div class="sidebar-header">
      <h2>Accent Colors</h2>
      <button class="aa-filter-toggle" id="aaFilterBtn" onclick="toggleAAFilter()" title="Show only colors that pass AA contrast on navy">
        <span class="aa-filter-dot"></span>
        AA Only
      </button>
    </div>

    <div class="color-group">
      <div class="color-group-label">Current</div>
      <div class="color-option active" data-color="#a6ed0c" data-name="Go Green (Current)" onclick="setColor(this)">
        <div class="color-swatch" style="background:#a6ed0c"></div>
        <div class="color-info">
          <div class="color-name">Go Green (Current)</div>
          <div class="color-hex" onclick="event.stopPropagation(); copyHex('#a6ed0c')">#a6ed0c</div>
        </div>
        <button class="pin-btn" onclick="event.stopPropagation(); togglePin('#a6ed0c', 'Go Green')" title="Pin for comparison">&#128204;</button>
      </div>
    </div>

    <div class="color-group">
      <div class="color-group-label">Green Family</div>
      <div class="color-option" data-color="#50C878" data-name="Emerald" onclick="setColor(this)">
        <div class="color-swatch" style="background:#50C878"></div>
        <div class="color-info">
          <div class="color-name">Emerald</div>
          <div class="color-hex" onclick="event.stopPropagation(); copyHex('#50C878')">#50C878</div>
        </div>
        <button class="pin-btn" onclick="event.stopPropagation(); togglePin('#50C878', 'Emerald')" title="Pin for comparison">&#128204;</button>
      </div>
      <div class="color-option" data-color="#3EB489" data-name="Mint / Seafoam" onclick="setColor(this)">
        <div class="color-swatch" style="background:#3EB489"></div>
        <div class="color-info">
          <div class="color-name">Mint / Seafoam</div>
          <div class="color-hex" onclick="event.stopPropagation(); copyHex('#3EB489')">#3EB489</div>
        </div>
        <button class="pin-btn" onclick="event.stopPropagation(); togglePin('#3EB489', 'Mint')" title="Pin for comparison">&#128204;</button>
      </div>
      <div class="color-option" data-color="#00BFA5" data-name="Teal Green" onclick="setColor(this)">
        <div class="color-swatch" style="background:#00BFA5"></div>
        <div class="color-info">
          <div class="color-name">Teal Green</div>
          <div class="color-hex" onclick="event.stopPropagation(); copyHex('#00BFA5')">#00BFA5</div>
        </div>
        <button class="pin-btn" onclick="event.stopPropagation(); togglePin('#00BFA5', 'Teal')" title="Pin for comparison">&#128204;</button>
      </div>
      <div class="color-option" data-color="#4CAF50" data-name="Material Green" onclick="setColor(this)">
        <div class="color-swatch" style="background:#4CAF50"></div>
        <div class="color-info">
          <div class="color-name">Material Green</div>
          <div class="color-hex" onclick="event.stopPropagation(); copyHex('#4CAF50')">#4CAF50</div>
        </div>
        <button class="pin-btn" onclick="event.stopPropagation(); togglePin('#4CAF50', 'Material')" title="Pin for comparison">&#128204;</button>
      </div>
    </div>

    <div class="color-group">
      <div class="color-group-label">Blue-Green</div>
      <div class="color-option" data-color="#00D4FF" data-name="Electric Cyan" onclick="setColor(this)">
        <div class="color-swatch" style="background:#00D4FF"></div>
        <div class="color-info">
          <div class="color-name">Electric Cyan</div>
          <div class="color-hex" onclick="event.stopPropagation(); copyHex('#00D4FF')">#00D4FF</div>
        </div>
        <button class="pin-btn" onclick="event.stopPropagation(); togglePin('#00D4FF', 'Cyan')" title="Pin for comparison">&#128204;</button>
      </div>
      <div class="color-option" data-color="#40E0D0" data-name="Turquoise" onclick="setColor(this)">
        <div class="color-swatch" style="background:#40E0D0"></div>
        <div class="color-info">
          <div class="color-name">Turquoise</div>
          <div class="color-hex" onclick="event.stopPropagation(); copyHex('#40E0D0')">#40E0D0</div>
        </div>
        <button class="pin-btn" onclick="event.stopPropagation(); togglePin('#40E0D0', 'Turquoise')" title="Pin for comparison">&#128204;</button>
      </div>
    </div>

    <div class="color-group">
      <div class="color-group-label">Warm Alternatives</div>
      <div class="color-option" data-color="#FFB800" data-name="Amber Gold" onclick="setColor(this)">
        <div class="color-swatch" style="background:#FFB800"></div>
        <div class="color-info">
          <div class="color-name">Amber Gold</div>
          <div class="color-hex" onclick="event.stopPropagation(); copyHex('#FFB800')">#FFB800</div>
        </div>
        <button class="pin-btn" onclick="event.stopPropagation(); togglePin('#FFB800', 'Amber')" title="Pin for comparison">&#128204;</button>
      </div>
      <div class="color-option" data-color="#FF6B4A" data-name="Coral Orange" onclick="setColor(this)">
        <div class="color-swatch" style="background:#FF6B4A"></div>
        <div class="color-info">
          <div class="color-name">Coral Orange</div>
          <div class="color-hex" onclick="event.stopPropagation(); copyHex('#FF6B4A')">#FF6B4A</div>
        </div>
        <button class="pin-btn" onclick="event.stopPropagation(); togglePin('#FF6B4A', 'Coral')" title="Pin for comparison">&#128204;</button>
      </div>
    </div>

    <div class="custom-section">
      <h2>Custom Color</h2>
      <div class="custom-input-row">
        <input type="color" id="customPicker" value="#a6ed0c">
        <input type="text" id="customHex" placeholder="#a6ed0c" maxlength="7">
        <button onclick="applyCustom()">Apply</button>
      </div>
    </div>

    <div class="keyboard-hint">
      <kbd>&uarr;</kbd><kbd>&darr;</kbd> cycle &nbsp; <kbd>C</kbd> copy &nbsp; <kbd>Esc</kbd> clear pins
    </div>
  </aside>

  <main class="preview-area">
    <!-- Quick comparison strip -->
    <div class="comparison-strip strip-wrapper" id="comparisonStrip"></div>

    <!-- Side-by-side comparison (hidden by default) -->
    <div id="comparisonContainer" class="comparison-container"></div>

    <!-- Logo preview -->
    <div class="logo-preview-card">
      <div class="logo-text">hndl</div>
      <div class="logo-badge">
        <span>FLEET<br>MANAGEMENT</span>
      </div>
    </div>

    <!-- Preview grid -->
    <div class="preview-grid">
      <div class="preview-card card-on-navy">
        <h3>On Navy Blue</h3>
        <div class="sample-text">Fleet Efficiency</div>
        <div class="sample-body">Monitor your fleet performance in real-time with intelligent analytics and predictive insights.</div>
      </div>

      <div class="preview-card card-on-white">
        <h3>On Light Background</h3>
        <div class="sample-text">Fleet Efficiency</div>
        <div class="sample-body">Monitor your fleet performance in real-time with intelligent analytics and predictive insights.</div>
      </div>

      <div class="preview-card card-buttons">
        <h3>UI Elements</h3>
        <div class="btn-row">
          <div class="btn-sample btn-filled">Start Tracking</div>
          <div class="btn-sample btn-outline">View Reports</div>
          <div class="btn-sample btn-ghost">Learn More</div>
        </div>
      </div>

      <div class="preview-card card-dashboard">
        <h3>Dashboard Preview</h3>
        <div class="dash-stats">
          <div class="dash-stat">
            <div class="dash-stat-label">Vehicles</div>
            <div class="dash-stat-value">148</div>
          </div>
          <div class="dash-stat">
            <div class="dash-stat-label">Active</div>
            <div class="dash-stat-value">92%</div>
          </div>
        </div>
        <div class="dash-bar-chart">
          <div class="dash-bar" style="height:60%"></div>
          <div class="dash-bar" style="height:80%"></div>
          <div class="dash-bar" style="height:45%"></div>
          <div class="dash-bar" style="height:90%"></div>
          <div class="dash-bar" style="height:70%"></div>
          <div class="dash-bar" style="height:55%"></div>
          <div class="dash-bar" style="height:85%"></div>
          <div class="dash-bar" style="height:40%"></div>
          <div class="dash-bar" style="height:75%"></div>
          <div class="dash-bar" style="height:95%"></div>
        </div>
      </div>

      <!-- Form Elements -->
      <div class="preview-card card-form">
        <h3>Form Elements</h3>
        <div class="form-mock">
          <div class="form-label">Vehicle ID</div>
          <div class="form-input focused">FLT-2847</div>
          <div class="form-label">Status</div>
          <div class="form-select">
            <span>Active</span>
            <span class="form-select-arrow">&#9662;</span>
          </div>
          <div class="form-validation">&#10003; Vehicle registered successfully</div>
          <div class="form-checkbox-row">
            <div class="form-checkbox checked">&#10003;</div>
            <span>Enable GPS tracking</span>
          </div>
          <div class="form-radio-row">
            <div class="form-radio-item">
              <div class="form-radio selected"></div>
              <span>Real-time</span>
            </div>
            <div class="form-radio-item">
              <div class="form-radio"></div>
              <span>Batch</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Sidebar Navigation -->
      <div class="preview-card card-nav">
        <h3>Navigation</h3>
        <div class="nav-mock">
          <div class="nav-item">
            <div class="nav-item-left"><span class="nav-item-icon">&#9632;</span> Dashboard</div>
          </div>
          <div class="nav-item nav-active">
            <div class="nav-item-left"><span class="nav-item-icon">&#9733;</span> Fleet Map</div>
          </div>
          <div class="nav-item">
            <div class="nav-item-left"><span class="nav-item-icon">&#9881;</span> Vehicles</div>
          </div>
          <div class="nav-item">
            <div class="nav-item-left"><span class="nav-item-icon">&#9888;</span> Alerts</div>
            <span class="nav-badge">7</span>
          </div>
          <div class="nav-item">
            <div class="nav-item-left"><span class="nav-item-icon">&#128200;</span> Reports</div>
          </div>
          <div class="nav-user">
            <div class="nav-avatar">MK</div>
            <div class="nav-user-info">
              <div class="nav-user-name">Mohammed K.</div>
              <div class="nav-user-role">Fleet Manager</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Alerts & Notifications -->
      <div class="preview-card card-alerts">
        <h3>Notifications</h3>
        <div class="alerts-mock">
          <div class="alert-item alert-info">
            <span class="alert-icon">&#9432;</span>
            <div>
              <div class="alert-text"><strong>3 vehicles</strong> approaching service interval</div>
              <div class="alert-time">2 min ago</div>
            </div>
          </div>
          <div class="alert-item alert-success">
            <span class="alert-icon">&#10003;</span>
            <div>
              <div class="alert-text">Route optimization <strong>complete</strong> &mdash; saved 12% fuel</div>
              <div class="alert-time">15 min ago</div>
            </div>
          </div>
          <div class="alert-item alert-warning">
            <span class="alert-icon">&#9888;</span>
            <div>
              <div class="alert-text">FLT-091 reported <strong>low tire pressure</strong></div>
              <div class="alert-time">1 hr ago</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Toggles, Chips, Progress -->
      <div class="preview-card card-controls">
        <h3>Controls &amp; Indicators</h3>
        <div class="controls-mock">
          <div class="control-row">
            <span class="control-label">Live Tracking</span>
            <div class="toggle-switch on"></div>
          </div>
          <div class="control-row">
            <span class="control-label">Notifications</span>
            <div class="toggle-switch on"></div>
          </div>
          <div class="control-row">
            <span class="control-label">Eco Mode</span>
            <div class="toggle-switch"></div>
          </div>
          <div>
            <div class="form-label" style="margin-bottom:0.35rem">Filter by status</div>
            <div class="chips-row">
              <span class="chip chip-active">Active</span>
              <span class="chip chip-active">In Transit</span>
              <span class="chip">Idle</span>
              <span class="chip">Maintenance</span>
              <span class="chip">Offline</span>
            </div>
          </div>
          <div class="progress-bar-section">
            <div class="progress-bar-label"><span>Fleet Utilization</span><span>78%</span></div>
            <div class="progress-bar"><div class="progress-bar-fill" style="width:78%"></div></div>
          </div>
          <div class="progress-bar-section">
            <div class="progress-bar-label"><span>Route Completion</span><span>92%</span></div>
            <div class="progress-bar"><div class="progress-bar-fill" style="width:92%"></div></div>
          </div>
          <div>
            <span class="link-text">View detailed analytics &rarr;</span>
          </div>
        </div>
      </div>

      <!-- Data Table (full width) -->
      <div class="preview-card card-table">
        <h3>Data Table</h3>
        <div class="table-mock">
          <div class="table-header">
            <span class="sorted">Vehicle &#9660;</span>
            <span>Status</span>
            <span>Driver</span>
            <span>Fuel</span>
            <span>Action</span>
          </div>
          <div class="table-row row-selected">
            <span class="table-row-id">FLT-001</span>
            <span><span class="status-badge status-active"><span class="status-dot"></span>Active</span></span>
            <span>Ahmed R.</span>
            <span>
              <div class="table-progress"><div class="table-progress-fill" style="width:85%"></div></div>
            </span>
            <span class="table-action">View &rarr;</span>
          </div>
          <div class="table-row">
            <span class="table-row-id">FLT-002</span>
            <span><span class="status-badge status-active"><span class="status-dot"></span>Active</span></span>
            <span>Sara M.</span>
            <span>
              <div class="table-progress"><div class="table-progress-fill" style="width:62%"></div></div>
            </span>
            <span class="table-action">View &rarr;</span>
          </div>
          <div class="table-row">
            <span class="table-row-id">FLT-003</span>
            <span><span class="status-badge status-idle"><span class="status-dot"></span>Idle</span></span>
            <span>Omar K.</span>
            <span>
              <div class="table-progress"><div class="table-progress-fill" style="width:94%"></div></div>
            </span>
            <span class="table-action">View &rarr;</span>
          </div>
          <div class="table-row">
            <span class="table-row-id">FLT-004</span>
            <span><span class="status-badge status-offline"><span class="status-dot"></span>Offline</span></span>
            <span>Layla H.</span>
            <span>
              <div class="table-progress"><div class="table-progress-fill" style="width:41%"></div></div>
            </span>
            <span class="table-action">View &rarr;</span>
          </div>
          <div class="table-row">
            <span class="table-row-id">FLT-005</span>
            <span><span class="status-badge status-active"><span class="status-dot"></span>Active</span></span>
            <span>Khalid T.</span>
            <span>
              <div class="table-progress"><div class="table-progress-fill" style="width:73%"></div></div>
            </span>
            <span class="table-action">View &rarr;</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Tint/Shade palette -->
    <div class="palette-section" id="paletteSection">
      <h3>Tints &amp; Shades</h3>
      <div class="palette-row" id="paletteRow"></div>
    </div>

    <!-- Color harmonies -->
    <div class="harmony-section" id="harmonySection">
      <h3>Color Harmonies</h3>
      <div id="harmonyContent"></div>
    </div>

    <!-- Contrast ratios -->
    <div class="contrast-section">
      <div class="contrast-header">
        <h3>Accessibility — Contrast Ratios</h3>
        <div class="score-display" id="scoreDisplay">
          <div class="score-ring" id="scoreRing">--</div>
          <div>
            <div class="score-label" id="scoreLabel">--</div>
            <div class="score-sublabel">Suitability</div>
          </div>
        </div>
      </div>
      <div class="contrast-grid">
        <div class="contrast-item" id="contrastNavy">
          <div class="contrast-label">vs Navy (#083359)</div>
          <div class="contrast-ratio">--</div>
          <div class="contrast-badge">--</div>
        </div>
        <div class="contrast-item" id="contrastDark">
          <div class="contrast-label">vs Dark UI (#0A0E1A)</div>
          <div class="contrast-ratio">--</div>
          <div class="contrast-badge">--</div>
        </div>
        <div class="contrast-item" id="contrastWhite">
          <div class="contrast-label">vs White (#FFFFFF)</div>
          <div class="contrast-ratio">--</div>
          <div class="contrast-badge">--</div>
        </div>
        <div class="contrast-item" id="contrastNeutral">
          <div class="contrast-label">vs Neutral (#F5F5F5)</div>
          <div class="contrast-ratio">--</div>
          <div class="contrast-badge">--</div>
        </div>
      </div>
    </div>
  </main>
</div>

<script>
const allColors = [
  { color: '#a6ed0c', name: 'Go Green' },
  { color: '#50C878', name: 'Emerald' },
  { color: '#3EB489', name: 'Mint' },
  { color: '#00BFA5', name: 'Teal' },
  { color: '#4CAF50', name: 'Material' },
  { color: '#00D4FF', name: 'Cyan' },
  { color: '#40E0D0', name: 'Turquoise' },
  { color: '#FFB800', name: 'Amber' },
  { color: '#FF6B4A', name: 'Coral' },
];

let currentColor = '#a6ed0c';
let pinnedColors = []; // {color, name}
let aaFilterActive = false;

// ─── Color Utilities ───

function hexToRGB(hex) {
  const r = parseInt(hex.slice(1, 3), 16);
  const g = parseInt(hex.slice(3, 5), 16);
  const b = parseInt(hex.slice(5, 7), 16);
  return { r, g, b };
}

function rgbToHex(r, g, b) {
  return '#' + [r, g, b].map(c => Math.max(0, Math.min(255, Math.round(c))).toString(16).padStart(2, '0')).join('');
}

function hexToRgba(hex, alpha) {
  const { r, g, b } = hexToRGB(hex);
  return `rgba(${r},${g},${b},${alpha})`;
}

function getLuminance(hex) {
  const rgb = hexToRGB(hex);
  const [r, g, b] = [rgb.r, rgb.g, rgb.b].map(c => {
    c = c / 255;
    return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
  });
  return 0.2126 * r + 0.7152 * g + 0.0722 * b;
}

function getContrastRatio(hex1, hex2) {
  const l1 = getLuminance(hex1);
  const l2 = getLuminance(hex2);
  const lighter = Math.max(l1, l2);
  const darker = Math.min(l1, l2);
  return (lighter + 0.05) / (darker + 0.05);
}

function getContrastTextColor(hex) {
  return getLuminance(hex) > 0.4 ? '#083359' : '#ffffff';
}

// ─── HSL Conversions ───

function hexToHSL(hex) {
  let { r, g, b } = hexToRGB(hex);
  r /= 255; g /= 255; b /= 255;
  const max = Math.max(r, g, b), min = Math.min(r, g, b);
  let h, s, l = (max + min) / 2;
  if (max === min) {
    h = s = 0;
  } else {
    const d = max - min;
    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
    switch (max) {
      case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;
      case g: h = ((b - r) / d + 2) / 6; break;
      case b: h = ((r - g) / d + 4) / 6; break;
    }
  }
  return { h: h * 360, s: s * 100, l: l * 100 };
}

function hslToHex(h, s, l) {
  h = ((h % 360) + 360) % 360;
  s = Math.max(0, Math.min(100, s)) / 100;
  l = Math.max(0, Math.min(100, l)) / 100;
  const a = s * Math.min(l, 1 - l);
  const f = n => {
    const k = (n + h / 30) % 12;
    const color = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
    return Math.round(255 * color);
  };
  return rgbToHex(f(0), f(8), f(4));
}

// ─── Tint/Shade Generation ───

function generateTintsShades(hex) {
  const { r, g, b } = hexToRGB(hex);
  const percents = [0.75, 0.50, 0.25, 0.10];

  const shades = percents.map(pct => ({
    label: `-${pct * 100}%`,
    color: rgbToHex(
      Math.round(r * (1 - pct)),
      Math.round(g * (1 - pct)),
      Math.round(b * (1 - pct))
    )
  })).reverse();

  const tints = percents.reverse().map(pct => ({
    label: `+${pct * 100}%`,
    color: rgbToHex(
      Math.round(r + (255 - r) * pct),
      Math.round(g + (255 - g) * pct),
      Math.round(b + (255 - b) * pct)
    )
  }));

  return { shades, tints };
}

function renderPaletteStrip(hex) {
  const row = document.getElementById('paletteRow');
  const { shades, tints } = generateTintsShades(hex);
  const all = [...shades, { label: 'Base', color: hex, isOrigin: true }, ...tints];

  row.innerHTML = '';
  all.forEach(item => {
    const swatch = document.createElement('button');
    swatch.className = 'palette-swatch' + (item.isOrigin ? ' palette-origin' : '');
    swatch.style.background = item.color;
    swatch.onclick = () => {
      if (!item.isOrigin) {
        document.querySelectorAll('.color-option').forEach(o => o.classList.remove('active'));
        currentColor = item.color;
        applyColor(item.color);
      }
    };

    const tooltip = document.createElement('div');
    tooltip.className = 'palette-swatch-tooltip';
    tooltip.textContent = `${item.color.toUpperCase()} (${item.label})`;
    swatch.appendChild(tooltip);

    row.appendChild(swatch);
  });
}

// ─── Color Harmonies ───

function getHarmonies(hex) {
  const { h, s, l } = hexToHSL(hex);
  return {
    'Complementary': [hslToHex(h + 180, s, l)],
    'Analogous': [hslToHex(h - 30, s, l), hslToHex(h + 30, s, l)],
    'Triadic': [hslToHex(h + 120, s, l), hslToHex(h + 240, s, l)],
    'Split Comp.': [hslToHex(h + 150, s, l), hslToHex(h + 210, s, l)],
  };
}

function renderHarmonies(hex) {
  const container = document.getElementById('harmonyContent');
  const harmonies = getHarmonies(hex);
  container.innerHTML = '';

  Object.entries(harmonies).forEach(([name, colors]) => {
    const group = document.createElement('div');
    group.className = 'harmony-group';

    const label = document.createElement('div');
    label.className = 'harmony-group-label';
    label.textContent = name;
    group.appendChild(label);

    const row = document.createElement('div');
    row.className = 'harmony-swatches';

    colors.forEach(c => {
      const chip = document.createElement('div');
      chip.className = 'harmony-chip';
      if (aaFilterActive && getContrastRatio(c, '#083359') < 4.5) {
        chip.style.opacity = '0.25';
        chip.style.pointerEvents = 'none';
      }
      chip.onclick = () => {
        document.querySelectorAll('.color-option').forEach(o => o.classList.remove('active'));
        currentColor = c;
        applyColor(c);
      };

      const swatch = document.createElement('div');
      swatch.className = 'harmony-chip-swatch';
      swatch.style.background = c;

      const info = document.createElement('div');
      info.className = 'harmony-chip-info';

      const hexLabel = document.createElement('div');
      hexLabel.className = 'harmony-chip-hex';
      hexLabel.textContent = c.toUpperCase();
      hexLabel.style.cursor = 'pointer';
      hexLabel.onclick = (e) => { e.stopPropagation(); copyHex(c); };

      const badge = document.createElement('div');
      badge.className = 'harmony-chip-badge';
      const ratio = getContrastRatio(c, '#083359');
      if (ratio >= 4.5) {
        badge.textContent = 'AA on Navy';
        badge.classList.add('aa-pass');
      } else {
        badge.textContent = 'Fails Navy';
        badge.classList.add('aa-fail');
      }

      info.appendChild(hexLabel);
      info.appendChild(badge);
      chip.appendChild(swatch);
      chip.appendChild(info);
      row.appendChild(chip);
    });

    group.appendChild(row);
    container.appendChild(group);
  });
}

// ─── Suitability Score ───

function computeSuitabilityScore(color) {
  const checks = [
    { bg: '#083359', weight: 3 },
    { bg: '#0a0e1a', weight: 2 },
    { bg: '#FFFFFF', weight: 2 },
    { bg: '#F5F5F5', weight: 1 },
  ];
  let score = 0, maxScore = 0;
  checks.forEach(c => {
    const ratio = getContrastRatio(color, c.bg);
    maxScore += c.weight * 3;
    if (ratio >= 7) score += c.weight * 3;
    else if (ratio >= 4.5) score += c.weight * 2;
    else if (ratio >= 3) score += c.weight * 1;
  });
  return Math.round((score / maxScore) * 100);
}

function updateScore(color) {
  const score = computeSuitabilityScore(color);
  const ring = document.getElementById('scoreRing');
  const label = document.getElementById('scoreLabel');

  ring.textContent = score;

  let cls, text;
  if (score >= 80) { cls = 'score-excellent'; text = 'Excellent'; }
  else if (score >= 60) { cls = 'score-good'; text = 'Good'; }
  else if (score >= 40) { cls = 'score-fair'; text = 'Fair'; }
  else { cls = 'score-poor'; text = 'Poor'; }

  ring.className = 'score-ring ' + cls;
  label.className = 'score-label ' + cls;
  label.textContent = text;
}

// ─── Contrast Update (expanded) ───

function updateContrast(color) {
  const pairs = [
    { id: 'contrastNavy', bg: '#083359' },
    { id: 'contrastDark', bg: '#0a0e1a' },
    { id: 'contrastWhite', bg: '#FFFFFF' },
    { id: 'contrastNeutral', bg: '#F5F5F5' },
  ];
  pairs.forEach(p => {
    const ratio = getContrastRatio(color, p.bg);
    const el = document.getElementById(p.id);
    el.querySelector('.contrast-ratio').textContent = ratio.toFixed(2) + ':1';
    const badge = el.querySelector('.contrast-badge');
    if (ratio >= 7) {
      badge.textContent = 'AAA';
      badge.className = 'contrast-badge badge-pass-aaa';
    } else if (ratio >= 4.5) {
      badge.textContent = 'AA';
      badge.className = 'contrast-badge badge-pass';
    } else if (ratio >= 3) {
      badge.textContent = 'AA Large';
      badge.className = 'contrast-badge badge-warn';
    } else {
      badge.textContent = 'FAIL';
      badge.className = 'contrast-badge badge-fail';
    }
  });

  updateScore(color);
}

// ─── Build Comparison Strip ───

function buildStrip() {
  const strip = document.getElementById('comparisonStrip');
  strip.innerHTML = '';
  allColors.forEach(c => {
    const div = document.createElement('div');
    const isActive = c.color.toUpperCase() === currentColor.toUpperCase();
    const isPinned = pinnedColors.some(p => p.color.toUpperCase() === c.color.toUpperCase());
    div.className = 'strip-swatch' + (isActive ? ' active-strip' : '') + (isPinned ? ' pinned-strip' : '');
    div.style.background = c.color;
    div.title = c.name + ' ' + c.color;
    div.onclick = () => {
      const opt = document.querySelector(`.color-option[data-color="${c.color}"]`);
      if (opt) setColor(opt);
      else {
        currentColor = c.color;
        applyColor(c.color);
      }
    };
    const label = document.createElement('div');
    label.className = 'strip-swatch-label';
    label.textContent = c.name;
    div.appendChild(label);
    strip.appendChild(div);
  });
}

// ─── Pin / Comparison Mode ───

function togglePin(color, name) {
  const idx = pinnedColors.findIndex(p => p.color.toUpperCase() === color.toUpperCase());
  if (idx > -1) {
    pinnedColors.splice(idx, 1);
  } else {
    if (pinnedColors.length >= 2) pinnedColors.shift();
    pinnedColors.push({ color, name });
  }
  updatePinButtons();
  renderComparison();
  buildStrip();
}

function clearPins() {
  pinnedColors = [];
  updatePinButtons();
  renderComparison();
  buildStrip();
}

function updatePinButtons() {
  document.querySelectorAll('.pin-btn').forEach(btn => {
    const option = btn.closest('.color-option');
    if (!option) return;
    const color = option.dataset.color;
    const isPinned = pinnedColors.some(p => p.color.toUpperCase() === color.toUpperCase());
    btn.classList.toggle('pinned', isPinned);
  });
}

function renderComparison() {
  const container = document.getElementById('comparisonContainer');

  if (pinnedColors.length === 0) {
    container.classList.remove('visible');
    container.innerHTML = '';
    return;
  }

  container.classList.add('visible');

  // Build columns: current + pinned
  const colorsToCompare = [
    { color: currentColor, name: getColorName(currentColor) || 'Current' },
    ...pinnedColors
  ];

  let html = `
    <div style="width:100%">
      <div class="comparison-header">
        <h3>Side-by-Side Comparison</h3>
        <button class="clear-pins-btn" onclick="clearPins()">Clear Pins</button>
      </div>
      <div style="display:flex; gap:1rem;">
  `;

  colorsToCompare.forEach(item => {
    const score = computeSuitabilityScore(item.color);
    let scoreCls;
    if (score >= 80) scoreCls = 'score-excellent';
    else if (score >= 60) scoreCls = 'score-good';
    else if (score >= 40) scoreCls = 'score-fair';
    else scoreCls = 'score-poor';

    const textColor = getContrastTextColor(item.color);
    const contrastPairs = [
      { label: 'Navy', bg: '#083359' },
      { label: 'Dark UI', bg: '#0a0e1a' },
      { label: 'White', bg: '#FFFFFF' },
      { label: 'Neutral', bg: '#F5F5F5' },
    ];

    html += `
      <div class="comparison-column">
        <div class="comparison-column-header">
          <div class="comparison-column-swatch" style="background:${item.color}"></div>
          <div>
            <div class="comparison-column-name">${item.name}</div>
            <div class="comparison-column-hex" style="cursor:pointer" onclick="copyHex('${item.color}')">${item.color.toUpperCase()}</div>
          </div>
        </div>
        <div class="comp-logo">
          <div class="comp-logo-text" style="color:${item.color}">hndl</div>
          <div class="comp-logo-badge">
            <span style="color:${item.color}">FLEET<br>MGMT</span>
          </div>
        </div>
        <div class="comp-buttons">
          <div class="comp-btn" style="background:${item.color}; color:${textColor}">Filled Button</div>
          <div class="comp-btn" style="background:transparent; border:2px solid ${item.color}; color:${item.color}">Outline Button</div>
        </div>
        <div class="comp-contrast-list">
    `;

    contrastPairs.forEach(p => {
      const ratio = getContrastRatio(item.color, p.bg);
      let badgeText, badgeColor;
      if (ratio >= 7) { badgeText = 'AAA'; badgeColor = '#eab308'; }
      else if (ratio >= 4.5) { badgeText = 'AA'; badgeColor = '#22c55e'; }
      else if (ratio >= 3) { badgeText = 'AA Lg'; badgeColor = '#f59e0b'; }
      else { badgeText = 'FAIL'; badgeColor = '#ef4444'; }

      html += `
        <div class="comp-contrast-row">
          <span class="comp-contrast-bg">${p.label}</span>
          <span class="comp-contrast-value">${ratio.toFixed(1)}:1 <span style="color:${badgeColor}; font-size:0.55rem">${badgeText}</span></span>
        </div>
      `;
    });

    html += `
        </div>
        <div class="comp-score ${scoreCls}" style="background:${hexToRgba(item.color, 0.08)}">
          Score: ${score}/100
        </div>
      </div>
    `;
  });

  html += `</div></div>`;
  container.innerHTML = html;
}

function getColorName(hex) {
  const found = allColors.find(c => c.color.toUpperCase() === hex.toUpperCase());
  return found ? found.name : null;
}

// ─── AA Filter ───

function toggleAAFilter() {
  aaFilterActive = !aaFilterActive;
  document.getElementById('aaFilterBtn').classList.toggle('active', aaFilterActive);
  applyAAFilter();
}

function applyAAFilter() {
  document.querySelectorAll('.color-option').forEach(opt => {
    const color = opt.dataset.color;
    if (aaFilterActive) {
      const ratio = getContrastRatio(color, '#083359');
      opt.classList.toggle('aa-filtered', ratio < 4.5);
    } else {
      opt.classList.remove('aa-filtered');
    }
  });
  // Re-render harmonies with filter
  renderHarmonies(currentColor);
}

// ─── Copy Hex ───

let copyTimeout;
function copyHex(hex) {
  navigator.clipboard.writeText(hex.toUpperCase()).catch(() => {});
  const toast = document.getElementById('copyToast');
  toast.textContent = `Copied ${hex.toUpperCase()}`;
  toast.classList.add('show');
  clearTimeout(copyTimeout);
  copyTimeout = setTimeout(() => toast.classList.remove('show'), 1500);
}

// ─── URL Hash State ───

function updateHash(color) {
  const clean = color.replace('#', '');
  if (window.location.hash !== '#color=' + clean) {
    history.replaceState(null, '', '#color=' + clean);
  }
}

function initFromHash() {
  const hash = window.location.hash;
  const match = hash.match(/color=([0-9a-fA-F]{6})/);
  if (match) {
    const color = '#' + match[1];
    currentColor = color;
    const opt = document.querySelector(`.color-option[data-color="${color}" i]`);
    if (opt) {
      document.querySelectorAll('.color-option').forEach(o => o.classList.remove('active'));
      opt.classList.add('active');
    }
    return color;
  }
  return null;
}

// ─── Set / Apply Color ───

function setColor(el) {
  document.querySelectorAll('.color-option').forEach(o => o.classList.remove('active'));
  el.classList.add('active');
  const color = el.dataset.color;
  currentColor = color;
  applyColor(color);
}

function applyColor(color) {
  document.documentElement.style.setProperty('--current-accent', color);

  // Set RGB components for rgba() usage in CSS
  const rgb = hexToRGB(color);
  document.documentElement.style.setProperty('--accent-rgb', `${rgb.r},${rgb.g},${rgb.b}`);

  // Update buttons
  const btnFilled = document.querySelector('.btn-filled');
  const btnOutline = document.querySelector('.btn-outline');
  const btnGhost = document.querySelector('.btn-ghost');
  if (btnFilled) {
    btnFilled.style.background = color;
    btnFilled.style.color = getContrastTextColor(color);
  }
  if (btnOutline) {
    btnOutline.style.borderColor = color;
    btnOutline.style.color = color;
  }
  if (btnGhost) {
    btnGhost.style.background = hexToRgba(color, 0.1);
    btnGhost.style.color = color;
  }

  // Update form focus ring
  const focusedInput = document.querySelector('.form-input.focused');
  if (focusedInput) {
    focusedInput.style.borderColor = color;
    focusedInput.style.boxShadow = `0 0 0 3px ${hexToRgba(color, 0.15)}`;
  }

  // Update table selected row
  const selectedRow = document.querySelector('.table-row.row-selected');
  if (selectedRow) {
    selectedRow.style.background = hexToRgba(color, 0.04);
    selectedRow.style.borderLeftColor = color;
  }

  // Update nav active item background
  const navActive = document.querySelector('.nav-item.nav-active');
  if (navActive) {
    navActive.style.background = hexToRgba(color, 0.08);
  }

  // Update active chips background
  document.querySelectorAll('.chip.chip-active').forEach(chip => {
    chip.style.background = hexToRgba(color, 0.1);
    chip.style.borderColor = color;
    chip.style.color = color;
  });

  // Update active status badges
  document.querySelectorAll('.status-badge.status-active').forEach(badge => {
    badge.style.background = hexToRgba(color, 0.1);
    badge.style.color = color;
  });

  // Update alert-info border
  const alertInfo = document.querySelector('.alert-item.alert-info');
  if (alertInfo) {
    alertInfo.style.background = hexToRgba(color, 0.06);
    alertInfo.style.borderLeftColor = color;
  }

  // Contrast + Score
  updateContrast(color);

  // Strip
  buildStrip();

  // Tint/Shade
  renderPaletteStrip(color);

  // Harmonies
  renderHarmonies(color);

  // Comparison (update if pins active)
  if (pinnedColors.length > 0) renderComparison();

  // Custom picker sync
  document.getElementById('customPicker').value = color;
  document.getElementById('customHex').value = color;

  // URL hash
  updateHash(color);
}

function applyCustom() {
  const picker = document.getElementById('customPicker');
  const hex = document.getElementById('customHex');
  let color = hex.value || picker.value;
  if (!color.startsWith('#')) color = '#' + color;
  if (/^#[0-9a-fA-F]{6}$/.test(color)) {
    document.querySelectorAll('.color-option').forEach(o => o.classList.remove('active'));
    currentColor = color;
    applyColor(color);
  }
}

document.getElementById('customPicker').addEventListener('input', (e) => {
  document.getElementById('customHex').value = e.target.value;
});

document.getElementById('customHex').addEventListener('keydown', (e) => {
  if (e.key === 'Enter') applyCustom();
});

// ─── Keyboard Navigation ───

document.addEventListener('keydown', (e) => {
  if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;

  const options = [...document.querySelectorAll('.color-option:not(.aa-filtered)')];
  const activeIdx = options.findIndex(o => o.classList.contains('active'));

  if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {
    e.preventDefault();
    const next = options[(activeIdx + 1) % options.length];
    if (next) setColor(next);
  } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
    e.preventDefault();
    const prev = options[(activeIdx - 1 + options.length) % options.length];
    if (prev) setColor(prev);
  } else if (e.key === 'c' && !e.ctrlKey && !e.metaKey) {
    copyHex(currentColor);
  } else if (e.key === 'Escape') {
    clearPins();
  }
});

// ─── Mode Toggle ───

function toggleMode() {
  document.body.classList.toggle('light-mode');
  const isLight = document.body.classList.contains('light-mode');
  document.getElementById('modeIcon').innerHTML = isLight ? '&#9728;' : '&#9790;';
  document.getElementById('modeLabel').textContent = isLight ? 'Light' : 'Dark';
}

// ─── Init ───

const hashColor = initFromHash();
applyColor(hashColor || '#a6ed0c');
</script>
</body>
</html>
